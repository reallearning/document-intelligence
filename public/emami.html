<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emami Multi-Agent Supply Chain Intelligence Network</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(ellipse at center, #1a237e 0%, #0d47a1 50%, #01579b 100%);
            min-height: 100vh;
            padding: 10px;
            overflow: hidden;
        }
        
        .container {
            max-width: 100vw;
            height: 100vh;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
            display: grid;
            grid-template-rows: auto auto 1fr auto;
            gap: 10px;
        }
        
        .header {
            text-align: center;
            z-index: 100;
            padding-bottom: 5px;
            border-bottom: 2px solid #e8f5e9;
        }
        
        .header h1 {
            color: #1b5e20;
            font-size: 1.6em;
            margin-bottom: 3px;
            background: linear-gradient(45deg, #2e7d32, #1b5e20, #004d40);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .header p {
            color: #546e7a;
            font-size: 0.9em;
        }
        
        .header .subtitle {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 5px;
        }
        
        .header .subtitle span {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.75em;
            color: #78909c;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            z-index: 100;
        }
        
        .question-card {
            background: linear-gradient(135deg, #f1f8e9, #e8f5e9);
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .question-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #4caf50, #2e7d32);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .question-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(46, 125, 50, 0.2);
            border-color: #4caf50;
        }
        
        .question-card:hover::before {
            opacity: 1;
        }
        
        .question-card.active {
            background: linear-gradient(135deg, #2e7d32, #1b5e20);
            color: white;
            border-color: #1b5e20;
        }
        
        .question-card.active::before {
            opacity: 1;
            background: linear-gradient(90deg, #81c784, #a5d6a7);
        }
        
        .question-card h3 {
            font-size: 0.95em;
            margin-bottom: 6px;
            color: inherit;
        }
        
        .question-card p {
            font-size: 0.8em;
            opacity: 0.85;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .question-card .pattern {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.7em;
            font-weight: 600;
            display: inline-block;
        }
        
        .question-card:not(.active) .pattern {
            background: rgba(46, 125, 50, 0.1);
            color: #2e7d32;
        }
        
        .question-card .season-tag {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 0.65em;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: 600;
        }
        
        .question-card:not(.active) .season-tag.winter {
            background: #e3f2fd;
            color: #1565c0;
        }
        
        .question-card:not(.active) .season-tag.summer {
            background: #fff3e0;
            color: #ef6c00;
        }
        
        .question-card:not(.active) .season-tag.launch {
            background: #fce4ec;
            color: #c2185b;
        }
        
        .question-card.active .season-tag {
            background: rgba(255, 255, 255, 0.25);
            color: white;
        }
        
        .network-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        .network-svg {
            width: 100%;
            height: 100%;
        }
        
        /* Network Edges */
        .edge {
            stroke: #c8e6c9;
            stroke-width: 2;
            fill: none;
            opacity: 0.5;
            transition: all 0.5s ease;
        }
        
        .edge.active {
            stroke: #4caf50;
            stroke-width: 4;
            opacity: 1;
            animation: pulseEdge 2s ease-in-out infinite;
        }
        
        .edge.completed {
            stroke: #2e7d32;
            stroke-width: 3;
            opacity: 0.8;
        }
        
        @keyframes pulseEdge {
            0%, 100% { stroke-dasharray: 0; }
            50% { stroke-dasharray: 10, 5; }
        }
        
        /* Data Flow Animation */
        .data-flow {
            fill: #4caf50;
            r: 4;
            opacity: 0;
        }
        
        .data-flow.active {
            opacity: 1;
            animation: flowData 3s ease-in-out;
        }
        
        @keyframes flowData {
            0% { opacity: 1; r: 3; }
            50% { opacity: 1; r: 6; }
            100% { opacity: 0; r: 3; }
        }
        
        /* Network Nodes */
        .node {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .node circle {
            fill: #f5f5f5;
            stroke: #e0e0e0;
            stroke-width: 3;
            transition: all 0.3s ease;
        }
        
        .node.active circle {
            fill: #4caf50;
            stroke: #2e7d32;
            stroke-width: 4;
            animation: nodeGlow 2s ease-in-out infinite;
        }
        
        .node.completed circle {
            fill: #2e7d32;
            stroke: #1b5e20;
        }
        
        .node.processing circle {
            fill: #ff9800;
            stroke: #f57c00;
            animation: nodeProcess 1.5s ease-in-out infinite;
        }
        
        .node.iteration circle {
            fill: #ff5722;
            stroke: #e64a19;
            animation: nodeIteration 1s ease-in-out infinite;
        }
        
        @keyframes nodeGlow {
            0%, 100% { filter: drop-shadow(0 0 5px rgba(76, 175, 80, 0.5)); }
            50% { filter: drop-shadow(0 0 15px rgba(76, 175, 80, 0.8)); }
        }
        
        @keyframes nodeProcess {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        @keyframes nodeIteration {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        .node text {
            text-anchor: middle;
            dominant-baseline: middle;
            font-size: 8px;
            font-weight: 600;
            fill: #37474f;
            pointer-events: none;
        }
        
        /* Keep text always readable */
        .node.active text, .node.completed text, .node.processing text, .node.iteration text {
            fill: #263238;
            font-weight: 700;
        }
        
        /* Special node types */
        .classifier circle {
            fill: #7b1fa2;
            stroke: #6a1b9a;
            r: 35;
        }
        
        .knowledge-graph circle {
            fill: #00897b;
            stroke: #00796b;
        }
        
        .agent circle {
            fill: #1976d2;
            stroke: #1565c0;
        }
        
        .compiler circle {
            fill: #d32f2f;
            stroke: #c62828;
        }
        
        .tool circle {
            fill: #5c6bc0;
            stroke: #3f51b5;
        }
        
        /* Decision Points */
        .decision-point {
            fill: #ffa000;
            stroke: #ff8f00;
            stroke-width: 3;
        }
        
        /* Tooltips */
        .tooltip {
            position: absolute;
            background: rgba(33, 33, 33, 0.95);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 11px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            max-width: 220px;
            border-left: 3px solid #4caf50;
        }
        
        .tooltip.show {
            opacity: 1;
        }
        
        .tooltip strong {
            color: #81c784;
        }
        
        /* Side Panels */
        .side-panels {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 12px;
            height: 140px;
        }
        
        .status-panel {
            background: linear-gradient(135deg, #f5f5f5, #eeeeee);
            border-radius: 15px;
            padding: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            overflow-y: auto;
            border: 1px solid #e0e0e0;
        }
        
        .status-panel h3 {
            color: #37474f;
            margin-bottom: 8px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 3px 0;
            border-bottom: 1px solid #e8e8e8;
            font-size: 0.8em;
        }
        
        .status-item:last-child {
            border-bottom: none;
        }
        
        .status-badge {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 8px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-badge.waiting {
            background: #f5f5f5;
            color: #9e9e9e;
        }
        
        .status-badge.active {
            background: #4caf50;
            color: white;
            animation: pulse 1.5s infinite;
        }
        
        .status-badge.completed {
            background: #2e7d32;
            color: white;
        }
        
        .status-badge.iteration {
            background: #ff5722;
            color: white;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* Execution Log */
        .log-panel {
            background: linear-gradient(135deg, #263238, #37474f);
            color: #eceff1;
            border-radius: 15px;
            padding: 12px;
            font-family: 'Consolas', 'Monaco', monospace;
            overflow-y: auto;
            font-size: 0.75em;
            border: 1px solid #455a64;
        }
        
        .log-header {
            font-weight: bold;
            margin-bottom: 8px;
            color: #81c784;
            display: flex;
            align-items: center;
            gap: 8px;
            padding-bottom: 6px;
            border-bottom: 1px solid #455a64;
        }
        
        .log-entry {
            margin-bottom: 3px;
            opacity: 0;
            animation: fadeInLog 0.5s ease forwards;
            line-height: 1.4;
        }
        
        .log-entry.iteration {
            color: #ffb74d;
        }
        
        .log-entry.highlight {
            background: rgba(255, 183, 77, 0.1);
            padding: 2px 5px;
            border-radius: 3px;
            border-left: 2px solid #ff9800;
        }
        
        .log-entry.success {
            color: #81c784;
        }
        
        .log-entry.data {
            color: #90caf9;
            padding-left: 15px;
        }
        
        @keyframes fadeInLog {
            to { opacity: 1; }
        }
        
        .timestamp {
            color: #78909c;
            margin-right: 8px;
            font-size: 0.9em;
        }
        
        /* Branch Labels */
        .branch-label {
            font-size: 7px;
            fill: #90a4ae;
            text-anchor: middle;
        }
        
        /* Iteration Indicators */
        .iteration-indicator {
            position: absolute;
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.7em;
            font-weight: 600;
            z-index: 150;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(255, 152, 0, 0.4);
        }
        
        .iteration-indicator.show {
            opacity: 1;
            transform: scale(1);
            animation: bounce 0.6s ease;
        }
        
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* Powered by badge */
        .powered-by {
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 0.7em;
            color: #90a4ae;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .powered-by strong {
            color: #2e7d32;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè≠ Emami Multi-Agent Supply Chain Intelligence Network</h1>
            <p>Autonomous Decision Intelligence powered by Business Knowledge Graph</p>
            <div class="subtitle">
                <span>üìä Real-time Orchestration</span>
                <span>üîó End-to-end Lineage</span>
                <span>üéØ Outcome-driven Actions</span>
            </div>
        </div>
        
        <div class="controls">
            <div class="question-card" onclick="executeQuestion(1)">
                <span class="season-tag winter">‚ùÑÔ∏è WINTER</span>
                <h3>üìà Season Ramp-Up Planning</h3>
                <p>"Plan supply chain for BoroPlus & Zandu Balm winter season launch with promo & distribution strategy"</p>
                <div class="pattern">Multi-Agent Parallel Pattern</div>
            </div>
            
            <div class="question-card" onclick="executeQuestion(2)">
                <span class="season-tag summer">‚òÄÔ∏è SUMMER</span>
                <h3>üìâ Season Taper-Down Planning</h3>
                <p>"Optimize Navratna Oil inventory wind-down post-summer with markdown & redistribution strategy"</p>
                <div class="pattern">Sequential Optimization Pattern</div>
            </div>
            
            <div class="question-card" onclick="executeQuestion(3)">
                <span class="season-tag launch">üöÄ LAUNCH</span>
                <h3>üÜï New SKU Launch Planning</h3>
                <p>"Plan production & distribution for new Fair and Handsome variant launch across MT & E-commerce"</p>
                <div class="pattern">Multi-Round Iterative Pattern</div>
            </div>
        </div>
        
        <div class="network-container">
            <svg class="network-svg" id="networkSvg" viewBox="0 0 1300 480">
                <!-- Edges and nodes will be dynamically generated -->
            </svg>
            
            <!-- Iteration indicators -->
            <div class="iteration-indicator" id="iteration1" style="top: 180px; left: 280px;">Phase 1: Demand</div>
            <div class="iteration-indicator" id="iteration2" style="top: 230px; left: 550px;">Phase 2: Supply</div>
            <div class="iteration-indicator" id="iteration3" style="top: 280px; left: 380px;">Phase 3: Execute</div>
            <div class="iteration-indicator" id="iteration4" style="top: 180px; left: 750px;">Phase 4: Optimize</div>
        </div>
        
        <div class="side-panels">
            <div class="status-panel">
                <h3>üìã Agent Execution Status</h3>
                <div id="statusContent">
                    <div class="status-item">
                        <span>Orchestrator</span>
                        <span class="status-badge waiting" id="classifier-status">Waiting</span>
                    </div>
                    <div class="status-item">
                        <span>Knowledge Graph</span>
                        <span class="status-badge waiting" id="kg-status">Ready</span>
                    </div>
                    <div class="status-item">
                        <span>Demand Sensing</span>
                        <span class="status-badge waiting" id="agent1-status">Standby</span>
                    </div>
                    <div class="status-item">
                        <span>Inventory Agent</span>
                        <span class="status-badge waiting" id="agent2-status">Standby</span>
                    </div>
                    <div class="status-item">
                        <span>Distribution Agent</span>
                        <span class="status-badge waiting" id="agent3-status">Standby</span>
                    </div>
                    <div class="status-item">
                        <span>Promo Agent</span>
                        <span class="status-badge waiting" id="agent4-status">Standby</span>
                    </div>
                    <div class="status-item">
                        <span>Production Agent</span>
                        <span class="status-badge waiting" id="agent5-status">Standby</span>
                    </div>
                    <div class="status-item">
                        <span>Response Compiler</span>
                        <span class="status-badge waiting" id="compiler-status">Waiting</span>
                    </div>
                </div>
            </div>
            
            <div class="log-panel" id="logPanel">
                <div class="log-header">üîÑ Supply Chain Network Execution Log</div>
                <div id="logContent"></div>
            </div>
        </div>
        
        <div class="tooltip" id="tooltip"></div>
        <div class="powered-by">Powered by <strong>Questt AI</strong> Decision Intelligence</div>
    </div>

    <script>
        // Network structure definition for Emami Supply Chain
        const networkNodes = [
            // Core input/output nodes
            { id: 'user', x: 650, y: 35, r: 22, type: 'user', label: 'Planning\nRequest', description: 'Supply chain planning question or scenario' },
            { id: 'classifier', x: 650, y: 110, r: 38, type: 'classifier', label: 'Orchestrator\nAgent', description: 'Intent classification, agent routing & guardrails. Determines optimal execution pattern.' },
            
            // Business Knowledge Graph - Left side
            { id: 'bkg', x: 280, y: 180, r: 28, type: 'knowledge-graph', label: 'Business\nKnowledge\nGraph', description: 'Emami semantic backbone: Products, Channels, Regions, Seasons, Relationships' },
            { id: 'bkg-product', x: 150, y: 250, r: 18, type: 'knowledge-graph', label: 'Product\nHierarchy', description: 'SKU ‚Üí Brand ‚Üí Category mapping (BoroPlus, Navratna, Zandu, F&H)' },
            { id: 'bkg-channel', x: 280, y: 270, r: 18, type: 'knowledge-graph', label: 'Channel\nMapping', description: 'GT, MT, E-commerce, CSD channel structures & reach' },
            { id: 'bkg-region', x: 200, y: 330, r: 18, type: 'knowledge-graph', label: 'Region\nNetwork', description: 'Zone ‚Üí State ‚Üí District ‚Üí Distributor mapping' },
            { id: 'bkg-season', x: 350, y: 310, r: 18, type: 'knowledge-graph', label: 'Season\nPatterns', description: 'Historical seasonality curves, weather correlations' },
            { id: 'bkg-promo', x: 130, y: 320, r: 16, type: 'knowledge-graph', label: 'Promo\nCalendar', description: 'Trade schemes, consumer offers, festival mapping' },
            
            // Agent decision hub
            { id: 'decision-agents', x: 650, y: 200, r: 14, type: 'decision', label: 'Agent\nRouting', description: 'Dynamic routing to appropriate supply chain agents' },
            
            // Supply Chain Master Agents
            { id: 'agent-demand', x: 480, y: 290, r: 26, type: 'agent', label: 'Demand\nSensing\nAgent', description: 'Forecasting, trend analysis, demand signals from POS, weather, events' },
            { id: 'agent-inventory', x: 620, y: 290, r: 26, type: 'agent', label: 'Inventory\nOptimization\nAgent', description: 'Stock planning, safety stock, reorder points, aging analysis' },
            { id: 'agent-distribution', x: 760, y: 290, r: 26, type: 'agent', label: 'Distribution\nPlanning\nAgent', description: 'Logistics, channel allocation, warehouse optimization' },
            { id: 'agent-promo', x: 540, y: 370, r: 26, type: 'agent', label: 'Promo\nPlanning\nAgent', description: 'Promotional activity coordination, ROI optimization, trade schemes' },
            { id: 'agent-production', x: 700, y: 370, r: 26, type: 'agent', label: 'Production\nPlanning\nAgent', description: 'Manufacturing schedule, capacity planning, batch optimization' },
            
            // Tools and computations
            { id: 'tool-forecast', x: 400, y: 380, r: 16, type: 'tool', label: 'Demand\nForecast', description: 'ML-based demand prediction with seasonality' },
            { id: 'tool-safety-stock', x: 540, y: 440, r: 16, type: 'tool', label: 'Safety\nStock Calc', description: 'Service level based safety stock calculation' },
            { id: 'tool-allocation', x: 680, y: 440, r: 16, type: 'tool', label: 'Channel\nAllocation', description: 'Optimal stock allocation across GT/MT/Ecom' },
            { id: 'tool-promo-roi', x: 460, y: 440, r: 16, type: 'tool', label: 'Promo\nROI Calc', description: 'Promotional lift and ROI calculation' },
            { id: 'tool-production-schedule', x: 800, y: 430, r: 16, type: 'tool', label: 'Production\nScheduler', description: 'Batch sequencing and capacity optimization' },
            { id: 'tool-logistics', x: 860, y: 350, r: 16, type: 'tool', label: 'Logistics\nOptimizer', description: 'Route and warehouse optimization' },
            { id: 'tool-markdown', x: 620, y: 380, r: 16, type: 'tool', label: 'Markdown\nOptimizer', description: 'Price optimization for inventory clearance' },
            
            // Composition and output
            { id: 'decision-compile', x: 900, y: 290, r: 14, type: 'decision', label: 'Result\nMerge', description: 'Consolidate multi-agent findings' },
            { id: 'compiler', x: 1050, y: 220, r: 28, type: 'compiler', label: 'Response\nCompiler', description: 'Synthesize actionable plan with complete lineage' },
            { id: 'tool-format', x: 1100, y: 140, r: 16, type: 'compiler', label: 'Action\nPlan', description: 'Formatted recommendations and timelines' },
            { id: 'tool-lineage', x: 1150, y: 280, r: 16, type: 'compiler', label: 'Decision\nLineage', description: 'How & why: Full computation provenance' },
            { id: 'tool-alerts', x: 1180, y: 200, r: 16, type: 'compiler', label: 'Risk\nAlerts', description: 'Exception flags and risk indicators' },
            
            // Output
            { id: 'output', x: 1050, y: 80, r: 24, type: 'user', label: 'Supply Chain\nAction Plan', description: 'Defensible, executable plan with full lineage' }
        ];
        
        const networkEdges = [
            // Main flow
            { from: 'user', to: 'classifier', label: 'Query' },
            { from: 'classifier', to: 'bkg', label: 'Context' },
            { from: 'classifier', to: 'decision-agents', label: 'Route' },
            
            // BKG operations
            { from: 'bkg', to: 'bkg-product', label: 'Products' },
            { from: 'bkg', to: 'bkg-channel', label: 'Channels' },
            { from: 'bkg', to: 'bkg-region', label: 'Regions' },
            { from: 'bkg', to: 'bkg-season', label: 'Seasons' },
            { from: 'bkg', to: 'bkg-promo', label: 'Promos' },
            { from: 'bkg-product', to: 'classifier', label: 'SKUs' },
            { from: 'bkg-channel', to: 'classifier', label: 'Routes' },
            { from: 'bkg-region', to: 'classifier', label: 'Network' },
            { from: 'bkg-season', to: 'classifier', label: 'Patterns' },
            { from: 'bkg-promo', to: 'classifier', label: 'Calendar' },
            
            // Agent routing
            { from: 'decision-agents', to: 'agent-demand', label: 'Demand' },
            { from: 'decision-agents', to: 'agent-inventory', label: 'Stock' },
            { from: 'decision-agents', to: 'agent-distribution', label: 'Logistics' },
            { from: 'decision-agents', to: 'agent-promo', label: 'Promo' },
            { from: 'decision-agents', to: 'agent-production', label: 'Mfg' },
            
            // Tool execution
            { from: 'agent-demand', to: 'tool-forecast', label: 'Predict' },
            { from: 'agent-inventory', to: 'tool-safety-stock', label: 'Calculate' },
            { from: 'agent-inventory', to: 'tool-markdown', label: 'Optimize' },
            { from: 'agent-distribution', to: 'tool-allocation', label: 'Allocate' },
            { from: 'agent-distribution', to: 'tool-logistics', label: 'Route' },
            { from: 'agent-promo', to: 'tool-promo-roi', label: 'ROI' },
            { from: 'agent-production', to: 'tool-production-schedule', label: 'Schedule' },
            
            // Cross-agent communication
            { from: 'agent-demand', to: 'agent-inventory', label: 'Forecast' },
            { from: 'agent-demand', to: 'agent-production', label: 'Signal' },
            { from: 'agent-inventory', to: 'agent-distribution', label: 'Stock' },
            { from: 'agent-promo', to: 'agent-demand', label: 'Lift' },
            { from: 'agent-production', to: 'agent-inventory', label: 'Supply' },
            
            // Results flow
            { from: 'tool-forecast', to: 'decision-compile', label: 'Demand' },
            { from: 'tool-safety-stock', to: 'decision-compile', label: 'Stock' },
            { from: 'tool-allocation', to: 'decision-compile', label: 'Split' },
            { from: 'tool-promo-roi', to: 'decision-compile', label: 'ROI' },
            { from: 'tool-production-schedule', to: 'decision-compile', label: 'Plan' },
            { from: 'tool-logistics', to: 'decision-compile', label: 'Routes' },
            { from: 'tool-markdown', to: 'decision-compile', label: 'Price' },
            
            // Compilation
            { from: 'decision-compile', to: 'compiler', label: 'Compile' },
            { from: 'compiler', to: 'tool-format', label: 'Format' },
            { from: 'compiler', to: 'tool-lineage', label: 'Lineage' },
            { from: 'compiler', to: 'tool-alerts', label: 'Alerts' },
            { from: 'tool-format', to: 'output', label: 'Plan' },
            { from: 'tool-lineage', to: 'output', label: 'Audit' },
            { from: 'tool-alerts', to: 'output', label: 'Risks' }
        ];
        
        let currentExecution = [];
        let executionStep = 0;
        let selectedQuestion = 0;
        
        function initializeNetwork() {
            const svg = document.getElementById('networkSvg');
            svg.innerHTML = '';
            
            // Create edges first
            const edgesGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            edgesGroup.id = 'edges';
            svg.appendChild(edgesGroup);
            
            networkEdges.forEach((edge, index) => {
                const fromNode = networkNodes.find(n => n.id === edge.from);
                const toNode = networkNodes.find(n => n.id === edge.to);
                
                if (fromNode && toNode) {
                    // Create edge line
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', fromNode.x);
                    line.setAttribute('y1', fromNode.y);
                    line.setAttribute('x2', toNode.x);
                    line.setAttribute('y2', toNode.y);
                    line.classList.add('edge');
                    line.id = `edge-${edge.from}-${edge.to}`;
                    edgesGroup.appendChild(line);
                    
                    // Create edge label
                    const midX = (fromNode.x + toNode.x) / 2;
                    const midY = (fromNode.y + toNode.y) / 2;
                    const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    label.setAttribute('x', midX);
                    label.setAttribute('y', midY - 3);
                    label.textContent = edge.label;
                    label.classList.add('branch-label');
                    edgesGroup.appendChild(label);
                    
                    // Create data flow circle
                    const dataFlow = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    dataFlow.setAttribute('cx', fromNode.x);
                    dataFlow.setAttribute('cy', fromNode.y);
                    dataFlow.setAttribute('r', 4);
                    dataFlow.classList.add('data-flow');
                    dataFlow.id = `flow-${edge.from}-${edge.to}`;
                    edgesGroup.appendChild(dataFlow);
                }
            });
            
            // Create nodes
            const nodesGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            nodesGroup.id = 'nodes';
            svg.appendChild(nodesGroup);
            
            networkNodes.forEach(node => {
                const nodeGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                nodeGroup.classList.add('node');
                nodeGroup.id = `node-${node.id}`;
                
                // Create circle
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', node.x);
                circle.setAttribute('cy', node.y);
                circle.setAttribute('r', node.r);
                if (node.type === 'decision') {
                    circle.classList.add('decision-point');
                } else {
                    circle.classList.add(node.type);
                }
                nodeGroup.appendChild(circle);
                
                // Create text label
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', node.x);
                text.setAttribute('y', node.y);
                
                // Handle multi-line text
                if (node.label.includes('\n')) {
                    const lines = node.label.split('\n');
                    lines.forEach((line, index) => {
                        const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');
                        tspan.setAttribute('x', node.x);
                        tspan.setAttribute('y', node.y + (index - (lines.length - 1) / 2) * 10);
                        tspan.textContent = line;
                        text.appendChild(tspan);
                    });
                } else {
                    text.textContent = node.label;
                }
                
                nodeGroup.appendChild(text);
                
                // Add event listeners
                nodeGroup.addEventListener('mouseenter', (e) => showTooltip(e, node));
                nodeGroup.addEventListener('mouseleave', hideTooltip);
                
                nodesGroup.appendChild(nodeGroup);
            });
        }
        
        function showTooltip(event, node) {
            const tooltip = document.getElementById('tooltip');
            const displayLabel = node.label.replace(/\n/g, ' ');
            tooltip.innerHTML = `<strong>${displayLabel}</strong><br>${node.description}`;
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
            tooltip.classList.add('show');
        }
        
        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('show');
        }
        
        function updateNodeStatus(nodeId, status) {
            const node = document.getElementById(`node-${nodeId}`);
            if (node) {
                node.classList.remove('active', 'completed', 'processing', 'iteration');
                if (status !== 'waiting') {
                    node.classList.add(status);
                }
            }
        }
        
        function updateStatusPanel(nodeId, status) {
            const statusMap = {
                'classifier': 'classifier-status',
                'bkg': 'kg-status',
                'agent-demand': 'agent1-status',
                'agent-inventory': 'agent2-status',
                'agent-distribution': 'agent3-status',
                'agent-promo': 'agent4-status',
                'agent-production': 'agent5-status',
                'compiler': 'compiler-status'
            };
            
            const statusElement = document.getElementById(statusMap[nodeId]);
            if (statusElement) {
                statusElement.className = `status-badge ${status}`;
                const statusText = {
                    'waiting': 'Standby',
                    'active': 'Running',
                    'completed': 'Done',
                    'iteration': 'Iterating',
                    'processing': 'Processing'
                };
                statusElement.textContent = statusText[status] || status;
            }
        }
        
        function activateEdge(fromId, toId) {
            const edge = document.getElementById(`edge-${fromId}-${toId}`);
            const flow = document.getElementById(`flow-${fromId}-${toId}`);
            
            if (edge) {
                edge.classList.add('active');
                setTimeout(() => {
                    edge.classList.remove('active');
                    edge.classList.add('completed');
                }, 2000);
            }
            
            if (flow) {
                flow.classList.add('active');
                setTimeout(() => {
                    flow.classList.remove('active');
                }, 3000);
            }
        }
        
        function showIteration(iterationId) {
            document.getElementById(iterationId).classList.add('show');
            setTimeout(() => {
                document.getElementById(iterationId).classList.remove('show');
            }, 3500);
        }
        
        function addLog(message, type = 'normal') {
            const timestamp = new Date().toLocaleTimeString();
            const logContent = document.getElementById('logContent');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            if (type === 'iteration') {
                entry.classList.add('highlight');
            }
            entry.innerHTML = `<span class="timestamp">[${timestamp}]</span>${message}`;
            logContent.appendChild(entry);
            logContent.scrollTop = logContent.scrollHeight;
        }
        
        async function executeQuestion(questionNumber) {
            // Reset and highlight selected question
            document.querySelectorAll('.question-card').forEach(card => card.classList.remove('active'));
            document.querySelectorAll('.question-card')[questionNumber - 1].classList.add('active');
            
            resetNetwork();
            selectedQuestion = questionNumber;
            
            const questions = [
                null, // index 0 unused
                {
                    title: "Winter Season Ramp-Up",
                    question: "Plan supply chain for BoroPlus & Zandu Balm winter season launch with promo & distribution strategy",
                    pattern: "season-rampup"
                },
                {
                    title: "Summer Season Taper-Down", 
                    question: "Optimize Navratna Oil inventory wind-down post-summer with markdown & redistribution strategy",
                    pattern: "season-taperdown"
                },
                {
                    title: "New SKU Launch",
                    question: "Plan production & distribution for new Fair and Handsome variant launch across MT & E-commerce",
                    pattern: "new-launch"
                }
            ];
            
            const currentQ = questions[questionNumber];
            addLog(`üè≠ Starting: ${currentQ.title}`, 'success');
            addLog(`üìã "${currentQ.question}"`);
            
            // Common initial steps
            await commonInitialSteps(questionNumber);
            
            // Execute based on pattern
            switch (currentQ.pattern) {
                case 'season-rampup':
                    await executeSeasonRampUp();
                    break;
                case 'season-taperdown':
                    await executeSeasonTaperDown();
                    break;
                case 'new-launch':
                    await executeNewLaunch();
                    break;
            }
        }
        
        async function commonInitialSteps(qNumber) {
            // Step 1: User submits planning request
            updateNodeStatus('user', 'active');
            addLog('üë§ Supply Chain Planner: Submitting planning request');
            await delay(800);
            
            // Step 2: Orchestrator receives and analyzes
            activateEdge('user', 'classifier');
            updateNodeStatus('user', 'completed');
            updateNodeStatus('classifier', 'active');
            updateStatusPanel('classifier', 'active');
            addLog('üéØ Orchestrator Agent: Analyzing intent & determining execution pattern');
            await delay(1200);
            
            // Step 3: BKG contextual enrichment
            activateEdge('classifier', 'bkg');
            updateNodeStatus('bkg', 'active');
            updateStatusPanel('bkg', 'active');
            addLog('üß† Business Knowledge Graph: Loading Emami context');
            await delay(800);
            
            // Step 4: BKG sub-operations
            activateEdge('bkg', 'bkg-product');
            activateEdge('bkg', 'bkg-channel');
            activateEdge('bkg', 'bkg-region');
            activateEdge('bkg', 'bkg-season');
            activateEdge('bkg', 'bkg-promo');
            updateNodeStatus('bkg-product', 'active');
            updateNodeStatus('bkg-channel', 'active');
            updateNodeStatus('bkg-region', 'active');
            updateNodeStatus('bkg-season', 'active');
            updateNodeStatus('bkg-promo', 'active');
            
            if (qNumber === 1) {
                addLog('   ‚Üí Product: BoroPlus (Skin Care), Zandu Balm (Healthcare)', 'data');
                addLog('   ‚Üí Season: Winter peak Oct-Feb, North/East India focus', 'data');
                addLog('   ‚Üí Channels: GT 65%, MT 25%, E-com 10%', 'data');
            } else if (qNumber === 2) {
                addLog('   ‚Üí Product: Navratna Oil (Hair & Scalp), Cooling variants', 'data');
                addLog('   ‚Üí Season: Summer peak Mar-Jun, All-India distribution', 'data');
                addLog('   ‚Üí Inventory: Current stock 45 days, Target 20 days', 'data');
            } else {
                addLog('   ‚Üí Product: Fair and Handsome (Men\'s Grooming) - New SKU', 'data');
                addLog('   ‚Üí Launch: MT & E-commerce first, GT rollout Phase 2', 'data');
                addLog('   ‚Üí Target: 5,000 MT outlets, Top 3 e-commerce platforms', 'data');
            }
            await delay(2000);
            
            // Step 5: BKG returns enriched context
            activateEdge('bkg-product', 'classifier');
            activateEdge('bkg-channel', 'classifier');
            activateEdge('bkg-region', 'classifier');
            activateEdge('bkg-season', 'classifier');
            activateEdge('bkg-promo', 'classifier');
            updateNodeStatus('bkg-product', 'completed');
            updateNodeStatus('bkg-channel', 'completed');
            updateNodeStatus('bkg-region', 'completed');
            updateNodeStatus('bkg-season', 'completed');
            updateNodeStatus('bkg-promo', 'completed');
            updateNodeStatus('bkg', 'completed');
            updateStatusPanel('bkg', 'completed');
            addLog('‚úÖ BKG: Context enrichment complete - entities mapped', 'success');
            await delay(800);
        }
        
        async function executeSeasonRampUp() {
            addLog('üìà Pattern: Multi-Agent Parallel Execution for Season Ramp-Up', 'iteration');
            
            // Phase 1: Demand Sensing
            showIteration('iteration1');
            activateEdge('classifier', 'decision-agents');
            updateNodeStatus('decision-agents', 'active');
            addLog('üîÄ Orchestrator: Initiating parallel agent execution');
            await delay(1000);
            
            // Activate Demand Agent first
            activateEdge('decision-agents', 'agent-demand');
            updateNodeStatus('agent-demand', 'active');
            updateStatusPanel('agent-demand', 'active');
            addLog('üìä Demand Sensing Agent: Analyzing winter demand patterns');
            await delay(1500);
            
            // Demand forecasting
            activateEdge('agent-demand', 'tool-forecast');
            updateNodeStatus('tool-forecast', 'active');
            addLog('   ‚Üí Historical: BoroPlus +180% Nov-Jan vs baseline', 'data');
            addLog('   ‚Üí Weather signal: La Ni√±a = colder winter, +15% uplift expected', 'data');
            addLog('   ‚Üí Zandu Balm correlation: Cold wave days ‚Üí 2.3x sales spike', 'data');
            await delay(2500);
            
            updateNodeStatus('tool-forecast', 'completed');
            addLog('üìà Forecast: BoroPlus 12.5L cases, Zandu 8.2L cases (Oct-Feb)', 'success');
            
            // Phase 2: Parallel - Promo + Production Planning
            showIteration('iteration2');
            
            // Promo Agent
            activateEdge('decision-agents', 'agent-promo');
            updateNodeStatus('agent-promo', 'active');
            updateStatusPanel('agent-promo', 'active');
            addLog('üéØ Promo Planning Agent: Designing winter campaign');
            
            // Production Agent simultaneously
            activateEdge('decision-agents', 'agent-production');
            updateNodeStatus('agent-production', 'active');
            updateStatusPanel('agent-production', 'active');
            addLog('ÔøΩicing Production Agent: Planning manufacturing ramp-up');
            await delay(1500);
            
            // Tool executions in parallel
            activateEdge('agent-promo', 'tool-promo-roi');
            activateEdge('agent-production', 'tool-production-schedule');
            updateNodeStatus('tool-promo-roi', 'active');
            updateNodeStatus('tool-production-schedule', 'active');
            
            addLog('   ‚Üí Promo: Diwali combo pack ‚Çπ199 (ROI 3.2x historical)', 'data');
            addLog('   ‚Üí Promo: Winter Care hamper for MT (margin 18%)', 'data');
            addLog('   ‚Üí Production: Silvassa plant ‚Üí 2 shifts, Capacity +40%', 'data');
            addLog('   ‚Üí Production: Batch size optimization ‚Üí 15% cost saving', 'data');
            await delay(2500);
            
            updateNodeStatus('tool-promo-roi', 'completed');
            updateNodeStatus('tool-production-schedule', 'completed');
            updateNodeStatus('agent-promo', 'completed');
            updateNodeStatus('agent-production', 'completed');
            updateStatusPanel('agent-promo', 'completed');
            updateStatusPanel('agent-production', 'completed');
            
            // Cross-agent communication
            activateEdge('agent-promo', 'agent-demand');
            addLog('üîÑ Promo ‚Üí Demand: Promotional lift factor 1.4x applied to forecast');
            await delay(1000);
            
            activateEdge('agent-production', 'agent-inventory');
            addLog('üîÑ Production ‚Üí Inventory: Supply plan committed');
            
            // Phase 3: Inventory + Distribution
            showIteration('iteration3');
            
            activateEdge('decision-agents', 'agent-inventory');
            activateEdge('decision-agents', 'agent-distribution');
            updateNodeStatus('agent-inventory', 'active');
            updateNodeStatus('agent-distribution', 'active');
            updateStatusPanel('agent-inventory', 'active');
            updateStatusPanel('agent-distribution', 'active');
            addLog('üì¶ Inventory Agent: Calculating stock requirements');
            addLog('üöö Distribution Agent: Planning channel allocation');
            await delay(1500);
            
            activateEdge('agent-inventory', 'tool-safety-stock');
            activateEdge('agent-distribution', 'tool-allocation');
            activateEdge('agent-distribution', 'tool-logistics');
            updateNodeStatus('tool-safety-stock', 'active');
            updateNodeStatus('tool-allocation', 'active');
            updateNodeStatus('tool-logistics', 'active');
            
            addLog('   ‚Üí Safety Stock: 21 days cover for BoroPlus (99% SL)', 'data');
            addLog('   ‚Üí Safety Stock: 18 days cover for Zandu Balm (98% SL)', 'data');
            addLog('   ‚Üí Allocation: North 45%, East 30%, West 15%, South 10%', 'data');
            addLog('   ‚Üí Pre-position: 8 super stockists by Sep 15', 'data');
            await delay(2500);
            
            // Cross-agent sync
            activateEdge('agent-demand', 'agent-inventory');
            activateEdge('agent-inventory', 'agent-distribution');
            addLog('üîÑ Demand ‚Üí Inventory ‚Üí Distribution: End-to-end sync complete');
            await delay(1000);
            
            updateNodeStatus('tool-safety-stock', 'completed');
            updateNodeStatus('tool-allocation', 'completed');
            updateNodeStatus('tool-logistics', 'completed');
            updateNodeStatus('agent-demand', 'completed');
            updateNodeStatus('agent-inventory', 'completed');
            updateNodeStatus('agent-distribution', 'completed');
            updateStatusPanel('agent-demand', 'completed');
            updateStatusPanel('agent-inventory', 'completed');
            updateStatusPanel('agent-distribution', 'completed');
            
            // Results compilation
            activateEdge('tool-forecast', 'decision-compile');
            activateEdge('tool-safety-stock', 'decision-compile');
            activateEdge('tool-allocation', 'decision-compile');
            activateEdge('tool-promo-roi', 'decision-compile');
            activateEdge('tool-production-schedule', 'decision-compile');
            activateEdge('tool-logistics', 'decision-compile');
            updateNodeStatus('decision-compile', 'active');
            addLog('üìä Merging all agent outputs into unified plan');
            await delay(1500);
            
            // Final compilation
            activateEdge('decision-compile', 'compiler');
            updateNodeStatus('classifier', 'completed');
            updateStatusPanel('classifier', 'completed');
            updateNodeStatus('compiler', 'active');
            updateStatusPanel('compiler', 'active');
            addLog('üìù Response Compiler: Generating actionable winter plan');
            await delay(1500);
            
            activateEdge('compiler', 'tool-format');
            activateEdge('compiler', 'tool-lineage');
            activateEdge('compiler', 'tool-alerts');
            updateNodeStatus('tool-format', 'active');
            updateNodeStatus('tool-lineage', 'active');
            updateNodeStatus('tool-alerts', 'active');
            
            addLog('üìã Action Plan Generated:', 'success');
            addLog('   ‚Üí Start production ramp: Sep 1 (Lead time: 45 days)', 'data');
            addLog('   ‚Üí Stock pre-positioning: Sep 15-30', 'data');
            addLog('   ‚Üí Promo launch: Oct 15 (Diwali -15 days)', 'data');
            addLog('   ‚Üí ‚ö†Ô∏è Alert: Silvassa capacity constrained Nov 15-30', 'data');
            await delay(2000);
            
            // Final output
            activateEdge('tool-format', 'output');
            activateEdge('tool-lineage', 'output');
            activateEdge('tool-alerts', 'output');
            updateNodeStatus('tool-format', 'completed');
            updateNodeStatus('tool-lineage', 'completed');
            updateNodeStatus('tool-alerts', 'completed');
            updateNodeStatus('compiler', 'completed');
            updateNodeStatus('output', 'active');
            updateStatusPanel('compiler', 'completed');
            
            addLog('‚úÖ Winter Season Ramp-Up Plan Complete', 'success');
            addLog('üìä 5 agents coordinated | 12 data sources | Full lineage attached', 'success');
        }
        
        async function executeSeasonTaperDown() {
            addLog('üìâ Pattern: Sequential Optimization for Season Taper-Down', 'iteration');
            
            // Phase 1: Current State Assessment
            showIteration('iteration1');
            activateEdge('classifier', 'decision-agents');
            updateNodeStatus('decision-agents', 'active');
            addLog('üîÄ Orchestrator: Sequential optimization pattern initiated');
            await delay(1000);
            
            // Inventory Assessment First
            activateEdge('decision-agents', 'agent-inventory');
            updateNodeStatus('agent-inventory', 'active');
            updateStatusPanel('agent-inventory', 'active');
            addLog('üì¶ Inventory Agent: Analyzing current Navratna stock position');
            await delay(1500);
            
            activateEdge('agent-inventory', 'tool-safety-stock');
            updateNodeStatus('tool-safety-stock', 'active');
            addLog('   ‚Üí Current stock: 4.2L cases across network', 'data');
            addLog('   ‚Üí Days of cover: 45 days (Target: 20 days post-season)', 'data');
            addLog('   ‚Üí Aging: 18% stock >60 days old', 'data');
            addLog('   ‚Üí Excess: 1.8L cases above optimal', 'data');
            await delay(2500);
            
            updateNodeStatus('tool-safety-stock', 'completed');
            
            // Phase 2: Demand Decay Analysis
            showIteration('iteration2');
            activateEdge('decision-agents', 'agent-demand');
            updateNodeStatus('agent-demand', 'active');
            updateStatusPanel('agent-demand', 'active');
            addLog('üìä Demand Sensing Agent: Modeling post-summer demand decay');
            await delay(1500);
            
            activateEdge('agent-demand', 'tool-forecast');
            updateNodeStatus('tool-forecast', 'active');
            addLog('   ‚Üí Jul demand: 65% of peak (actual vs forecast)', 'data');
            addLog('   ‚Üí Aug projected: 40% of peak', 'data');
            addLog('   ‚Üí Sep-Oct baseline: 25% of peak', 'data');
            addLog('   ‚Üí Regional variance: South sustains 15% longer', 'data');
            await delay(2500);
            
            updateNodeStatus('tool-forecast', 'completed');
            updateNodeStatus('agent-demand', 'completed');
            updateStatusPanel('agent-demand', 'completed');
            
            // Cross-agent: Demand informs Inventory
            activateEdge('agent-demand', 'agent-inventory');
            addLog('üîÑ Demand ‚Üí Inventory: Decay curve applied to stock plan');
            await delay(1000);
            
            // Phase 3: Markdown Strategy
            showIteration('iteration3');
            activateEdge('agent-inventory', 'tool-markdown');
            updateNodeStatus('tool-markdown', 'active');
            addLog('üí∞ Markdown Optimizer: Calculating optimal clearance strategy');
            addLog('   ‚Üí Tier 1 (0-30 days): No markdown, normal pricing', 'data');
            addLog('   ‚Üí Tier 2 (31-60 days): 8% off, bundle with Amla', 'data');
            addLog('   ‚Üí Tier 3 (>60 days): 15% off, push to CSD channel', 'data');
            addLog('   ‚Üí E-commerce flash: 20% off on Navratna Gold (slow mover)', 'data');
            await delay(2500);
            
            updateNodeStatus('tool-markdown', 'completed');
            updateNodeStatus('agent-inventory', 'completed');
            updateStatusPanel('agent-inventory', 'completed');
            
            // Phase 4: Redistribution Planning
            showIteration('iteration4');
            activateEdge('decision-agents', 'agent-distribution');
            updateNodeStatus('agent-distribution', 'active');
            updateStatusPanel('agent-distribution', 'active');
            addLog('üöö Distribution Agent: Planning stock redistribution');
            await delay(1500);
            
            activateEdge('agent-distribution', 'tool-allocation');
            activateEdge('agent-distribution', 'tool-logistics');
            updateNodeStatus('tool-allocation', 'active');
            updateNodeStatus('tool-logistics', 'active');
            
            addLog('   ‚Üí Redistribute: North ‚Üí South 45K cases', 'data');
            addLog('   ‚Üí Redistribute: Tier 1 cities ‚Üí Tier 2/3 towns', 'data');
            addLog('   ‚Üí Warehouse consolidation: 4 ‚Üí 2 regional hubs', 'data');
            addLog('   ‚Üí Return to depot: Expired/damaged 2.1K cases', 'data');
            await delay(2500);
            
            // Cross-agent: Inventory to Distribution sync
            activateEdge('agent-inventory', 'agent-distribution');
            addLog('üîÑ Inventory ‚Üí Distribution: Stock movement plan aligned');
            await delay(1000);
            
            updateNodeStatus('tool-allocation', 'completed');
            updateNodeStatus('tool-logistics', 'completed');
            updateNodeStatus('agent-distribution', 'completed');
            updateStatusPanel('agent-distribution', 'completed');
            
            // Production wind-down
            activateEdge('decision-agents', 'agent-production');
            updateNodeStatus('agent-production', 'active');
            updateStatusPanel('agent-production', 'active');
            addLog('üè≠ Production Agent: Scheduling manufacturing wind-down');
            
            activateEdge('agent-production', 'tool-production-schedule');
            updateNodeStatus('tool-production-schedule', 'active');
            addLog('   ‚Üí Jul: Reduce to 1 shift (from 2)', 'data');
            addLog('   ‚Üí Aug: Batch size -50%, focus on base SKUs', 'data');
            addLog('   ‚Üí Sep: Maintenance window, line changeover to BoroPlus', 'data');
            await delay(2000);
            
            updateNodeStatus('tool-production-schedule', 'completed');
            updateNodeStatus('agent-production', 'completed');
            updateStatusPanel('agent-production', 'completed');
            
            // Results compilation
            activateEdge('tool-forecast', 'decision-compile');
            activateEdge('tool-safety-stock', 'decision-compile');
            activateEdge('tool-markdown', 'decision-compile');
            activateEdge('tool-allocation', 'decision-compile');
            activateEdge('tool-logistics', 'decision-compile');
            activateEdge('tool-production-schedule', 'decision-compile');
            updateNodeStatus('decision-compile', 'active');
            addLog('üìä Consolidating taper-down action plan');
            await delay(1500);
            
            // Final compilation
            activateEdge('decision-compile', 'compiler');
            updateNodeStatus('classifier', 'completed');
            updateStatusPanel('classifier', 'completed');
            updateNodeStatus('compiler', 'active');
            updateStatusPanel('compiler', 'active');
            addLog('üìù Response Compiler: Generating wind-down playbook');
            await delay(1500);
            
            activateEdge('compiler', 'tool-format');
            activateEdge('compiler', 'tool-lineage');
            activateEdge('compiler', 'tool-alerts');
            updateNodeStatus('tool-format', 'active');
            updateNodeStatus('tool-lineage', 'active');
            updateNodeStatus('tool-alerts', 'active');
            
            addLog('üìã Taper-Down Plan Generated:', 'success');
            addLog('   ‚Üí Week 1-2: Markdown Tier 1 launch (8% SKUs)', 'data');
            addLog('   ‚Üí Week 3-4: Stock redistribution North‚ÜíSouth', 'data');
            addLog('   ‚Üí Week 5-6: CSD/Canteen push for aged stock', 'data');
            addLog('   ‚Üí Financial impact: ‚Çπ2.3Cr margin protection vs fire sale', 'data');
            addLog('   ‚Üí ‚ö†Ô∏è Alert: 2.1K cases near expiry - prioritize', 'data');
            await delay(2000);
            
            // Final output
            activateEdge('tool-format', 'output');
            activateEdge('tool-lineage', 'output');
            activateEdge('tool-alerts', 'output');
            updateNodeStatus('tool-format', 'completed');
            updateNodeStatus('tool-lineage', 'completed');
            updateNodeStatus('tool-alerts', 'completed');
            updateNodeStatus('compiler', 'completed');
            updateNodeStatus('output', 'active');
            updateStatusPanel('compiler', 'completed');
            
            addLog('‚úÖ Season Taper-Down Plan Complete', 'success');
            addLog('üìä 4 agents sequential | Margin protected: ‚Çπ2.3Cr | Full lineage', 'success');
        }
        
        async function executeNewLaunch() {
            addLog('üöÄ Pattern: Multi-Round Iterative Planning for New SKU Launch', 'iteration');
            
            // Round 1: Market Sizing & Demand
            showIteration('iteration1');
            activateEdge('classifier', 'decision-agents');
            updateNodeStatus('decision-agents', 'active');
            updateNodeStatus('classifier', 'iteration');
            updateStatusPanel('classifier', 'iteration');
            addLog('üîÄ Round 1 - Orchestrator ‚Üí Demand Agent: "Size the opportunity"', 'iteration');
            await delay(1000);
            
            activateEdge('decision-agents', 'agent-demand');
            updateNodeStatus('agent-demand', 'active');
            updateStatusPanel('agent-demand', 'active');
            addLog('üìä Demand Agent: Analyzing men\'s grooming market for new F&H variant');
            await delay(1500);
            
            activateEdge('agent-demand', 'tool-forecast');
            updateNodeStatus('tool-forecast', 'active');
            addLog('   ‚Üí Category TAM: ‚Çπ4,200Cr (Men\'s Face Care)', 'data');
            addLog('   ‚Üí F&H current share: 18% (‚Çπ756Cr)', 'data');
            addLog('   ‚Üí New variant potential: ‚Çπ85Cr Y1 (cannibalization adj.)', 'data');
            addLog('   ‚Üí MT/E-com index: 2.3x vs GT for premium SKUs', 'data');
            await delay(2500);
            
            updateNodeStatus('tool-forecast', 'completed');
            updateNodeStatus('agent-demand', 'completed');
            updateStatusPanel('agent-demand', 'completed');
            addLog('   ‚Üí Demand Agent ‚Üí Orchestrator: "Y1 target 85Cr, MT+Ecom first"', 'iteration');
            await delay(1000);
            
            // Round 2: Distribution Strategy
            showIteration('iteration2');
            updateNodeStatus('classifier', 'processing');
            addLog('üîÄ Round 2 - Orchestrator ‚Üí Distribution: "Plan channel rollout"', 'iteration');
            
            activateEdge('decision-agents', 'agent-distribution');
            updateNodeStatus('agent-distribution', 'active');
            updateStatusPanel('agent-distribution', 'active');
            addLog('üöö Distribution Agent: Designing MT & E-commerce launch plan');
            await delay(1500);
            
            activateEdge('agent-distribution', 'tool-allocation');
            activateEdge('agent-distribution', 'tool-logistics');
            updateNodeStatus('tool-allocation', 'active');
            updateNodeStatus('tool-logistics', 'active');
            
            addLog('   ‚Üí MT outlets: Top 5,000 (DMart, Reliance, Spencer\'s, Big Bazaar)', 'data');
            addLog('   ‚Üí E-commerce: Amazon, Flipkart, Nykaa Man (exclusive 2 weeks)', 'data');
            addLog('   ‚Üí Initial shipment: 50K cases split 60:40 MT:Ecom', 'data');
            addLog('   ‚Üí Display: End-cap placement in Top 500 MT stores', 'data');
            await delay(2500);
            
            updateNodeStatus('tool-allocation', 'completed');
            updateNodeStatus('tool-logistics', 'completed');
            updateNodeStatus('agent-distribution', 'completed');
            updateStatusPanel('agent-distribution', 'completed');
            addLog('   ‚Üí Distribution ‚Üí Orchestrator: "5K MT + 3 e-com platforms ready"', 'iteration');
            await delay(1000);
            
            // Round 3: Production Planning
            showIteration('iteration3');
            addLog('üîÄ Round 3 - Orchestrator ‚Üí Production: "Plan manufacturing"', 'iteration');
            
            activateEdge('decision-agents', 'agent-production');
            updateNodeStatus('agent-production', 'active');
            updateStatusPanel('agent-production', 'active');
            addLog('üè≠ Production Agent: Planning new SKU manufacturing setup');
            await delay(1500);
            
            activateEdge('agent-production', 'tool-production-schedule');
            updateNodeStatus('tool-production-schedule', 'active');
            
            addLog('   ‚Üí Line setup: Pondicherry plant, Line 3 (dedicated)', 'data');
            addLog('   ‚Üí Batch economics: 5K cases MOQ, 8-week lead time', 'data');
            addLog('   ‚Üí Initial production: 75K cases (50K launch + 25K buffer)', 'data');
            addLog('   ‚Üí Packaging: New tube design, 6-week artwork approval', 'data');
            await delay(2500);
            
            // Cross-agent: Production informs Demand on constraints
            activateEdge('agent-demand', 'agent-production');
            addLog('üîÑ Production ‚Üí Demand: Lead time constraint shared');
            await delay(800);
            
            updateNodeStatus('tool-production-schedule', 'completed');
            updateNodeStatus('agent-production', 'completed');
            updateStatusPanel('agent-production', 'completed');
            addLog('   ‚Üí Production ‚Üí Orchestrator: "Launch ready T+10 weeks"', 'iteration');
            await delay(1000);
            
            // Round 4: Promo & Launch Campaign
            showIteration('iteration4');
            addLog('üîÄ Round 4 - Orchestrator ‚Üí Promo: "Design launch campaign"', 'iteration');
            
            activateEdge('decision-agents', 'agent-promo');
            updateNodeStatus('agent-promo', 'active');
            updateStatusPanel('agent-promo', 'active');
            addLog('üéØ Promo Agent: Designing launch promotional strategy');
            await delay(1500);
            
            activateEdge('agent-promo', 'tool-promo-roi');
            updateNodeStatus('tool-promo-roi', 'active');
            
            addLog('   ‚Üí E-com exclusive: 15% off + free mini (Week 1-2)', 'data');
            addLog('   ‚Üí MT launch: Buy 1 Get 1 50% off (Week 3-6)', 'data');
            addLog('   ‚Üí Influencer: 50 male grooming influencers seeding', 'data');
            addLog('   ‚Üí Sampling: 100K samples via e-com orders', 'data');
            addLog('   ‚Üí Projected ROI: 2.8x on launch spend', 'data');
            await delay(2500);
            
            // Cross-agent: Promo informs Demand on expected lift
            activateEdge('agent-promo', 'agent-demand');
            addLog('üîÑ Promo ‚Üí Demand: Launch lift factor 1.6x applied');
            await delay(800);
            
            updateNodeStatus('tool-promo-roi', 'completed');
            updateNodeStatus('agent-promo', 'completed');
            updateStatusPanel('agent-promo', 'completed');
            
            // Inventory planning based on all inputs
            activateEdge('decision-agents', 'agent-inventory');
            updateNodeStatus('agent-inventory', 'active');
            updateStatusPanel('agent-inventory', 'active');
            addLog('üì¶ Inventory Agent: Final stock planning with all inputs');
            
            activateEdge('agent-inventory', 'tool-safety-stock');
            updateNodeStatus('tool-safety-stock', 'active');
            activateEdge('agent-production', 'agent-inventory');
            activateEdge('agent-demand', 'agent-inventory');
            
            addLog('   ‚Üí Launch stock: 50K cases (4 weeks cover)', 'data');
            addLog('   ‚Üí Replenishment trigger: 15K cases', 'data');
            addLog('   ‚Üí E-com buffer: 2-day express stock at 3 FCs', 'data');
            await delay(2000);
            
            updateNodeStatus('tool-safety-stock', 'completed');
            updateNodeStatus('agent-inventory', 'completed');
            updateStatusPanel('agent-inventory', 'completed');
            
            // Final orchestrator decision
            updateNodeStatus('classifier', 'completed');
            updateStatusPanel('classifier', 'completed');
            addLog('‚úÖ Orchestrator: All 4 rounds complete, compiling launch plan');
            
            // Results compilation
            activateEdge('tool-forecast', 'decision-compile');
            activateEdge('tool-allocation', 'decision-compile');
            activateEdge('tool-production-schedule', 'decision-compile');
            activateEdge('tool-promo-roi', 'decision-compile');
            activateEdge('tool-safety-stock', 'decision-compile');
            activateEdge('tool-logistics', 'decision-compile');
            updateNodeStatus('decision-compile', 'active');
            await delay(1500);
            
            // Final compilation
            activateEdge('decision-compile', 'compiler');
            updateNodeStatus('compiler', 'active');
            updateStatusPanel('compiler', 'active');
            addLog('üìù Response Compiler: Generating comprehensive launch playbook');
            await delay(1500);
            
            activateEdge('compiler', 'tool-format');
            activateEdge('compiler', 'tool-lineage');
            activateEdge('compiler', 'tool-alerts');
            updateNodeStatus('tool-format', 'active');
            updateNodeStatus('tool-lineage', 'active');
            updateNodeStatus('tool-alerts', 'active');
            
            addLog('üìã New SKU Launch Plan Generated:', 'success');
            addLog('   ‚Üí T-10 weeks: Production setup & artwork approval', 'data');
            addLog('   ‚Üí T-4 weeks: Initial production run (75K cases)', 'data');
            addLog('   ‚Üí T-2 weeks: Stock positioning at MT & FC', 'data');
            addLog('   ‚Üí T-0: E-commerce exclusive launch', 'data');
            addLog('   ‚Üí T+2 weeks: MT rollout (5,000 stores)', 'data');
            addLog('   ‚Üí T+8 weeks: GT expansion decision point', 'data');
            addLog('   ‚Üí Y1 Revenue target: ‚Çπ85Cr | Investment: ‚Çπ12Cr', 'data');
            addLog('   ‚Üí ‚ö†Ô∏è Risk: E-com exclusivity may upset MT partners', 'data');
            await delay(2000);
            
            // Final output
            activateEdge('tool-format', 'output');
            activateEdge('tool-lineage', 'output');
            activateEdge('tool-alerts', 'output');
            updateNodeStatus('tool-format', 'completed');
            updateNodeStatus('tool-lineage', 'completed');
            updateNodeStatus('tool-alerts', 'completed');
            updateNodeStatus('compiler', 'completed');
            updateNodeStatus('output', 'active');
            updateStatusPanel('compiler', 'completed');
            
            addLog('‚úÖ New SKU Launch Plan Complete', 'success');
            addLog('üìä 4 rounds | 5 agents coordinated | 10-week timeline | Full lineage', 'success');
        }
        
        function resetNetwork() {
            // Reset all nodes
            networkNodes.forEach(node => {
                updateNodeStatus(node.id, 'waiting');
            });
            
            // Reset all edges
            document.querySelectorAll('.edge').forEach(edge => {
                edge.classList.remove('active', 'completed');
            });
            
            // Reset status panel
            document.querySelectorAll('.status-badge').forEach(badge => {
                badge.className = 'status-badge waiting';
                badge.textContent = badge.id.includes('kg') ? 'Ready' : 'Standby';
            });
            
            // Hide iteration indicators
            document.querySelectorAll('.iteration-indicator').forEach(indicator => {
                indicator.classList.remove('show');
            });
            
            // Clear log
            document.getElementById('logContent').innerHTML = '';
            addLog('üîÑ Network reset - Select a scenario to see execution flow');
        }
        
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        // Initialize the network on page load
        document.addEventListener('DOMContentLoaded', () => {
            initializeNetwork();
            addLog('üè≠ Emami Multi-Agent Supply Chain Network initialized', 'success');
            addLog('üí° Select a planning scenario above to see the agentic execution flow');
            addLog('üìä Powered by Business Knowledge Graph for contextual intelligence');
        });
    </script>
</body>
</html>